<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Temperature Visualization</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            background-color: #1a1a2e; /* Dark background similar to screenshot */
            color: #e0e0e0;
        }
        .visualization-container {
            display: grid;
            /* Updated: Years as columns, Months as rows */
            /* grid-template-columns will be set dynamically by JS */
            grid-template-rows: repeat(12, 1fr); /* 12 rows for months */
            width: 800px; /* Adjust as needed */
            height: 400px; /* Adjust as needed */
            border: 1px solid #333;
            overflow: hidden;
            margin-bottom: 20px;
        }
        .temp-bar {
            width: 100%;
            height: 100%;
            /* Each bar will be colored by JS */
        }
        .description {
            width: 800px;
            text-align: center;
            font-size: 1.1em;
            line-height: 1.5;
            color: #b0b0b0;
        }
        .description strong {
            color: #ffffff;
        }
        .mode-toggle-bar {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
        }
        .mode-toggle-bar button {
            padding: 10px 20px;
            font-size: 1em;
            cursor: pointer;
            background-color: #333;
            color: #e0e0e0;
            border: 1px solid #555;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }
        .mode-toggle-bar button:hover {
            background-color: #555;
        }
        .mode-toggle-bar button.active {
            background-color: #007bff;
            border-color: #007bff;
            color: #ffffff;
        }

        .color-picker-container {
            display: flex;
            gap: 40px;
            margin-bottom: 20px;
            padding: 20px;
            background-color: #2a2a4a;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .color-picker {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .color-picker label {
            font-size: 1.1em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .slider-group {
            display: flex;
            flex-direction: column;
            width: 200px;
        }

        .slider-group label {
            font-size: 0.9em;
            font-weight: normal;
            margin-bottom: 2px;
        }

        .slider-group input[type="range"] {
            width: 100%;
            -webkit-appearance: none;
            height: 8px;
            border-radius: 5px;
            background: #555;
            outline: none;
            opacity: 0.7;
            transition: opacity .2s;
        }

        .slider-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #007bff;
            cursor: pointer;
        }

        .slider-group input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #007bff;
            cursor: pointer;
        }

        .hex-display {
            margin-top: 10px;
            padding: 8px;
            border: 1px solid #555;
            background-color: #333;
            color: #e0e0e0;
            border-radius: 4px;
            font-family: 'Courier New', Courier, monospace;
            width: 100px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="color-picker-container">
        <div class="color-picker">
            <label>Low Color</label>
            <div class="slider-group">
                <label for="low-hue">Hue:</label>
                <input type="range" id="low-hue" min="0" max="360">
            </div>
            <div class="slider-group">
                <label for="low-saturation">Saturation:</label>
                <input type="range" id="low-saturation" min="0" max="100">
            </div>
            <div class="slider-group">
                <label for="low-value">Value:</label>
                <input type="range" id="low-value" min="0" max="100">
            </div>
            <input type="text" id="low-hex-input" class="hex-display">
        </div>

        <div class="color-picker">
            <label>LowMid Color</label>
            <div class="slider-group">
                <label for="lowMid-hue">Hue:</label>
                <input type="range" id="lowMid-hue" min="0" max="360">
            </div>
            <div class="slider-group">
                <label for="lowMid-saturation">Saturation:</label>
                <input type="range" id="lowMid-saturation" min="0" max="100">
            </div>
            <div class="slider-group">
                <label for="lowMid-value">Value:</label>
                <input type="range" id="lowMid-value" min="0" max="100">
            </div>
            <input type="text" id="lowMid-hex-input" class="hex-display">
        </div>

        <div class="color-picker">
            <label>Mid Color</label>
            <div class="slider-group">
                <label for="mid-hue">Hue:</label>
                <input type="range" id="mid-hue" min="0" max="360">
            </div>
            <div class="slider-group">
                <label for="mid-saturation">Saturation:</label>
                <input type="range" id="mid-saturation" min="0" max="100">
            </div>
            <div class="slider-group">
                <label for="mid-value">Value:</label>
                <input type="range" id="mid-value" min="0" max="100">
            </div>
            <input type="text" id="mid-hex-input" class="hex-display">
        </div>

        <div class="color-picker">
            <label>HighMid Color</label>
            <div class="slider-group">
                <label for="highMid-hue">Hue:</label>
                <input type="range" id="highMid-hue" min="0" max="360">
            </div>
            <div class="slider-group">
                <label for="highMid-saturation">Saturation:</label>
                <input type="range" id="highMid-saturation" min="0" max="100">
            </div>
            <div class="slider-group">
                <label for="highMid-value">Value:</label>
                <input type="range" id="highMid-value" min="0" max="100">
            </div>
            <input type="text" id="highMid-hex-input" class="hex-display">
        </div>

        <div class="color-picker">
            <label>High Color</label>
            <div class="slider-group">
                <label for="high-hue">Hue:</label>
                <input type="range" id="high-hue" min="0" max="360">
            </div>
            <div class="slider-group">
                <label for="high-saturation">Saturation:</label>
                <input type="range" id="high-saturation" min="0" max="100">
            </div>
            <div class="slider-group">
                <label for="high-value">Value:</label>
                <input type="range" id="high-value" min="0" max="100">
            </div>
            <input type="text" id="high-hex-input" class="hex-display">
        </div>
    </div>

    <div class="mode-toggle-bar">
        <button id="temperature-mode-btn" class="active">Temperature Mode</button>
        <button id="anomaly-mode-btn">Anomaly Mode</button>
    </div>
    <div class="visualization-container" id="temp-visualization"></div>
    <p class="description" id="description-text"></p>

    <script>
        // Data Source for Temperature Anomalies: NOAA National Centers for Environmental Information (NCEI)
        // Global Time Series, Land+Ocean, Monthly, 1850-2024
        // URL: https://www.ncei.noaa.gov/access/monitoring/climate-at-a-glance/global/time-series/0,0/tavg/land_ocean/1/0/1850-2024
        const DATA_FILE_PATH = 'global-temperatures/1850-2024-Months.csv';

        // Data Source for Baseline Temperatures (1901-2000 average): NOAA NCEI
        // Global Climate Report - Data Info (provides details on the 1901-2000 baseline period)
        // URL: https://www.ncei.noaa.gov/access/monitoring/climate-at-a-glance/global/data-info
        const BASELINE_FILE_PATH = 'global-temperatures/baseline-1901-2020.json';
        let monthlyBaselineTemps = new Map(); // Map to store monthly baseline temperatures (month number -> temp in C)
        let annualOverallBaselineTempC; // Annual average baseline for description

        function celsiusToFahrenheit(celsius) {
            return (celsius * 9/5) + 32;
        }

        async function loadTemperatureData() {
            try {
                const [csvResponse, baselineResponse] = await Promise.all([
                    fetch(DATA_FILE_PATH),
                    fetch(BASELINE_FILE_PATH)
                ]);

                const csvText = await csvResponse.text();
                const baselineData = await baselineResponse.json();

                // Populate monthlyBaselineTemps map
                baselineData.monthlyAverages.forEach((avg, index) => {
                    // Month index is 0-based in array, but 1-based for actual month number
                    monthlyBaselineTemps.set(index + 1, avg.landAndOceanC);
                });
                annualOverallBaselineTempC = baselineData.annualAverage.landAndOceanC;

                return parseCSV(csvText);
            } catch (error) {
                console.error('Error loading data:', error);
                document.getElementById('temp-visualization').textContent = 'Failed to load data.';
                return [];
            }
        }

        function parseCSV(csv) {
            const lines = csv.trim().split('\n');
            // Skip header lines (lines starting with #) and the column header line
            const dataLines = lines.filter(line => !line.startsWith('#') && line.includes(','));
            
            const parsedData = [];
            for (const line of dataLines) {
                const [dateStr, anomalyStr] = line.split(',');
                const year = parseInt(dateStr.substring(0, 4));
                const month = parseInt(dateStr.substring(4, 6));
                const anomaly = parseFloat(anomalyStr);

                if (!isNaN(year) && !isNaN(month) && !isNaN(anomaly)) {
                    parsedData.push({ year, month, anomaly });
                }
            }
            return parsedData;
        }

        // Function to convert hex color to RGB
        function hexToRgb(hex) {
            const bigint = parseInt(hex.slice(1), 16);
            const r = (bigint >> 16) & 255;
            const g = (bigint >> 8) & 255;
            const b = bigint & 255;
            return { r, g, b };
        }

        // Function to convert RGB to HSL
        function rgbToHsl(r, g, b) {
            r /= 255;
            g /= 255;
            b /= 255;

            const max = Math.max(r, g, b);
            const min = Math.min(r, g, b);
            let h, s, l = (max + min) / 2;

            if (max === min) {
                h = s = 0; // achromatic
            } else {
                const d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                switch (max) {
                    case r:
                        h = (g - b) / d + (g < b ? 6 : 0);
                        break;
                    case g:
                        h = (b - r) / d + 2;
                        break;
                    case b:
                        h = (r - g) / d + 4;
                        break;
                }
                h /= 6;
            }

            return {
                h: Math.round(h * 360),
                s: Math.round(s * 100),
                l: Math.round(l * 100)
            };
        }

        // Function to convert HSL to RGB
        function hslToRgb(h, s, l) {
            h /= 360;
            s /= 100;
            l /= 100;
            let r, g, b;

            if (s === 0) {
                r = g = b = l; // achromatic
            } else {
                const hue2rgb = (p, q, t) => {
                    if (t < 0) t += 1;
                    if (t > 1) t -= 1;
                    if (t < 1 / 6) return p + (q - p) * 6 * t;
                    if (t < 1 / 2) return q;
                    if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;
                    return p;
                };

                const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                const p = 2 * l - q;
                r = hue2rgb(p, q, h + 1 / 3);
                g = hue2rgb(p, q, h);
                b = hue2rgb(p, q, h - 1 / 3);
            }

            return {
                r: Math.round(r * 255),
                g: Math.round(g * 255),
                b: Math.round(b * 255)
            };
        }

        // Function to convert RGB to Hex
        function rgbToHex(r, g, b) {
            return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1).toUpperCase();
        }

        // Function to convert HSV to HSL (since hslToRgb expects HSL)
        function hsvToHsl(h, s, v) {
            s /= 100;
            v /= 100;
            const l = (2 - s) * v / 2;
            const newS = l === 0 || l === 1 ? 0 : (s * v) / (l < 0.5 ? l * 2 : 2 - l * 2);
            return { h: h, s: newS * 100, l: l * 100 };
        }

        // Default hex color values
        const DEFAULT_LOW_COLOR_HEX = '#3300FF';
        const DEFAULT_LOW_MID_COLOR_HEX = '#50A0C0';
        const DEFAULT_MID_COLOR_HEX = '#FFFFFF';
        const DEFAULT_HIGH_MID_COLOR_HEX = '#FFB000';
        const DEFAULT_HIGH_COLOR_HEX = '#990000';

        // Initial color values (will be updated from hex inputs on DOMContentLoaded)
        let lowColor = { h: 0, s: 0, v: 0 };
        let lowMidColor = { h: 0, s: 0, v: 0 };
        let midColor = { h: 0, s: 0, v: 0 };
        let highMidColor = { h: 0, s: 0, v: 0 };
        let highColor = { h: 0, s: 0, v: 0 };

        // Function to convert HSV to HSL (since hslToRgb expects HSL)
        function hsvToHsl(h, s, v) {
            s /= 100;
            v /= 100;
            const l = (2 - s) * v / 2;
            const newS = l === 0 || l === 1 ? 0 : (s * v) / (l < 0.5 ? l * 2 : 2 - l * 2);
            return { h: h, s: newS * 100, l: l * 100 };
        }

        function getColorForValue(value, minVal, maxVal) {
            const normalizedValue = (value - minVal) / (maxVal - minVal);

            const lowHsl = hsvToHsl(lowColor.h, lowColor.s, lowColor.v);
            const lowMidHsl = hsvToHsl(lowMidColor.h, lowMidColor.s, lowMidColor.v);
            const midHsl = hsvToHsl(midColor.h, midColor.s, midColor.v);
            const highMidHsl = hsvToHsl(highMidColor.h, highMidColor.s, highMidColor.v);
            const highHsl = hsvToHsl(highColor.h, highColor.s, highColor.v);

            const colorLowRgb = hslToRgb(lowHsl.h, lowHsl.s, lowHsl.l);
            const colorLowMidRgb = hslToRgb(lowMidHsl.h, lowMidHsl.s, lowMidHsl.l);
            const colorMidRgb = hslToRgb(midHsl.h, midHsl.s, midHsl.l);
            const colorHighMidRgb = hslToRgb(highMidHsl.h, highMidHsl.s, highMidHsl.l);
            const colorHighRgb = hslToRgb(highHsl.h, highHsl.s, highHsl.l);

            let r, g, b;

            if (normalizedValue < 0.25) {
                // Transition from Low to LowMid
                const t = normalizedValue * 4; // Scale to 0-1 for this segment
                r = Math.round(colorLowRgb.r + (colorLowMidRgb.r - colorLowRgb.r) * t);
                g = Math.round(colorLowRgb.g + (colorLowMidRgb.g - colorLowRgb.g) * t);
                b = Math.round(colorLowRgb.b + (colorLowMidRgb.b - colorLowRgb.b) * t);
            } else if (normalizedValue < 0.5) {
                // Transition from LowMid to Mid
                const t = (normalizedValue - 0.25) * 4; // Scale to 0-1 for this segment
                r = Math.round(colorLowMidRgb.r + (colorMidRgb.r - colorLowMidRgb.r) * t);
                g = Math.round(colorLowMidRgb.g + (colorMidRgb.g - colorLowMidRgb.g) * t);
                b = Math.round(colorLowMidRgb.b + (colorMidRgb.b - colorLowMidRgb.b) * t);
            } else if (normalizedValue < 0.75) {
                // Transition from Mid to HighMid
                const t = (normalizedValue - 0.5) * 4; // Scale to 0-1 for this segment
                r = Math.round(colorMidRgb.r + (colorHighMidRgb.r - colorMidRgb.r) * t);
                g = Math.round(colorMidRgb.g + (colorHighMidRgb.g - colorMidRgb.g) * t);
                b = Math.round(colorMidRgb.b + (colorHighMidRgb.b - colorMidRgb.b) * t);
            } else {
                // Transition from HighMid to High
                const t = (normalizedValue - 0.75) * 4; // Scale to 0-1 for this segment
                r = Math.round(colorHighMidRgb.r + (colorHighRgb.r - colorHighMidRgb.r) * t);
                g = Math.round(colorHighMidRgb.g + (colorHighRgb.g - colorHighMidRgb.g) * t);
                b = Math.round(colorHighMidRgb.b + (colorHighRgb.b - colorHighMidRgb.b) * t);
            }
            return `rgb(${r}, ${g}, ${b})`;
        }

        let currentMode = 'temperature'; // 'temperature' or 'anomaly'
        let allData = []; // Store parsed data globally

        async function renderVisualization(mode) {
            currentMode = mode;
            const visualizationContainer = document.getElementById('temp-visualization');
            visualizationContainer.innerHTML = ''; // Clear previous visualization

            if (allData.length === 0) {
                allData = await loadTemperatureData();
                if (allData.length === 0) {
                    visualizationContainer.textContent = 'Failed to load temperature data.';
                    return;
                }
            }

            const dataToVisualize = currentMode === 'temperature'
                ? allData.map(d => d.anomaly + monthlyBaselineTemps.get(d.month))
                : allData.map(d => d.anomaly);

            const minVal = Math.min(...dataToVisualize);
            const maxVal = Math.max(...dataToVisualize);

            const startYear = allData[0].year;
            const endYear = allData[allData.length - 1].year;
            const numYears = endYear - startYear + 1;

            visualizationContainer.style.gridTemplateColumns = `repeat(${numYears}, 1fr)`;

            const monthlyDataMap = new Map();
            allData.forEach(d => {
                if (!monthlyDataMap.has(d.year)) {
                    monthlyDataMap.set(d.year, new Map());
                }
                monthlyDataMap.get(d.year).set(d.month, d); // Store full data object
            });

            for (let month = 1; month <= 12; month++) {
                for (let year = startYear; year <= endYear; year++) {
                    const tempBar = document.createElement('div');
                    tempBar.classList.add('temp-bar');
                    
                    const monthData = monthlyDataMap.has(year) && monthlyDataMap.get(year).has(month)
                        ? monthlyDataMap.get(year).get(month)
                        : null;

                    if (monthData !== null) {
                        let value;
                        let titleText;
                        if (currentMode === 'temperature') {
                            value = monthData.anomaly + monthlyBaselineTemps.get(monthData.month);
                            titleText = `Absolute: ${value.toFixed(2)}°C`;
                        } else { // anomaly mode
                            value = monthData.anomaly;
                            titleText = `Anomaly: ${value.toFixed(2)}°C`;
                        }
                        tempBar.style.backgroundColor = getColorForValue(value, minVal, maxVal);
                        tempBar.title = `Year: ${year}, Month: ${month}, ${titleText}`;
                    } else {
                        tempBar.style.backgroundColor = '#333'; 
                        tempBar.title = `Year: ${year}, Month: ${month}, Data Missing`;
                    }
                    
                    visualizationContainer.appendChild(tempBar);
                }
            }

            const descriptionElement = document.getElementById('description-text');
            if (currentMode === 'temperature') {
                const annualTemperatures = {};
                allData.forEach(d => {
                    if (!annualTemperatures[d.year]) {
                        annualTemperatures[d.year] = [];
                    }
                    annualTemperatures[d.year].push(d.anomaly + monthlyBaselineTemps.get(d.month));
                });

                const annualAverages = Object.values(annualTemperatures).map(temps => {
                    const sum = temps.reduce((acc, curr) => acc + curr, 0);
                    return sum / temps.length;
                });

                const minAnnualAvgC = Math.min(...annualAverages);
                const maxAnnualAvgC = Math.max(...annualAverages);
                const minAnnualAvgF = celsiusToFahrenheit(minAnnualAvgC);
                const maxAnnualAvgF = celsiusToFahrenheit(maxAnnualAvgC);

                descriptionElement.innerHTML = `
                    This visualization shows estimated global monthly average temperatures from January ${startYear} to December ${endYear}. Annual average temperatures range from <strong>${minAnnualAvgC.toFixed(1)}°C (${minAnnualAvgF.toFixed(1)}°F)</strong> to <strong>${maxAnnualAvgC.toFixed(1)}°C (${maxAnnualAvgC.toFixed(1)}°F)</strong>.
                `;
            } else { // anomaly mode
                const minAnomaly = Math.min(...allData.map(d => d.anomaly));
                const maxAnomaly = Math.max(...allData.map(d => d.anomaly));
                descriptionElement.innerHTML = `
                    This visualization shows global monthly temperature anomalies from January ${startYear} to December ${endYear}. Anomalies
                    range from <strong>${minAnomaly.toFixed(2)}°C</strong> to <strong>${maxAnomaly.toFixed(2)}°C</strong> relative to the 1901-2000 baseline.
                `;
            }

            // Update button active states
            document.getElementById('temperature-mode-btn').classList.toggle('active', currentMode === 'temperature');
            document.getElementById('anomaly-mode-btn').classList.toggle('active', currentMode === 'anomaly');
        }

        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('temperature-mode-btn').addEventListener('click', () => renderVisualization('temperature'));
            document.getElementById('anomaly-mode-btn').addEventListener('click', () => renderVisualization('anomaly'));

            // Helper function to update color and re-render
            function updateColor(colorType) {
                const hue = parseInt(document.getElementById(`${colorType}-hue`).value);
                const saturation = parseInt(document.getElementById(`${colorType}-saturation`).value);
                const value = parseInt(document.getElementById(`${colorType}-value`).value);

                if (colorType === 'low') {
                    lowColor = { h: hue, s: saturation, v: value };
                } else if (colorType === 'lowMid') {
                    lowMidColor = { h: hue, s: saturation, v: value };
                } else if (colorType === 'mid') {
                    midColor = { h: hue, s: saturation, v: value };
                } else if (colorType === 'highMid') {
                    highMidColor = { h: hue, s: saturation, v: value };
                } else if (colorType === 'high') {
                    highColor = { h: hue, s: saturation, v: value };
                }

                const hsl = hsvToHsl(hue, saturation, value);
                const rgb = hslToRgb(hsl.h, hsl.s, hsl.l);
                const hex = rgbToHex(rgb.r, rgb.g, rgb.b);
                document.getElementById(`${colorType}-hex-input`).value = hex;

                renderVisualization(currentMode);
            }

            // Helper function to update sliders from hex input
            function updateSlidersFromHex(colorType) {
                const hexInput = document.getElementById(`${colorType}-hex-input`);
                const hex = hexInput.value;

                if (!/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(hex)) {
                    // Invalid hex code, do not update
                    return;
                }

                const rgb = hexToRgb(hex);
                const hsl = rgbToHsl(rgb.r, rgb.g, rgb.b);

                // Convert HSL to HSV for consistency with existing color model
                const h = hsl.h;
                const s = hsl.s;
                const l = hsl.l;
                const v = l + s * Math.min(l, 100 - l) / 100;
                const newS = v === 0 ? 0 : 2 * (1 - l / v) * 100;

                document.getElementById(`${colorType}-hue`).value = h;
                document.getElementById(`${colorType}-saturation`).value = newS;
                document.getElementById(`${colorType}-value`).value = v;

                // Update the color object and re-render
                if (colorType === 'low') {
                    lowColor = { h: h, s: newS, v: v };
                } else if (colorType === 'lowMid') {
                    lowMidColor = { h: h, s: newS, v: v };
                } else if (colorType === 'mid') {
                    midColor = { h: h, s: newS, v: v };
                } else if (colorType === 'highMid') {
                    highMidColor = { h: h, s: newS, v: v };
                } else if (colorType === 'high') {
                    highColor = { h: h, s: newS, v: v };
                }

                renderVisualization(currentMode);
            }

            // Add event listeners for low color sliders
            document.getElementById('low-hue').addEventListener('input', () => updateColor('low'));
            document.getElementById('low-saturation').addEventListener('input', () => updateColor('low'));
            document.getElementById('low-value').addEventListener('input', () => updateColor('low'));
            document.getElementById('low-hex-input').addEventListener('change', () => updateSlidersFromHex('low')); // 'change' event for hex input

            // Add event listeners for lowMid color sliders
            document.getElementById('lowMid-hue').addEventListener('input', () => updateColor('lowMid'));
            document.getElementById('lowMid-saturation').addEventListener('input', () => updateColor('lowMid'));
            document.getElementById('lowMid-value').addEventListener('input', () => updateColor('lowMid'));
            document.getElementById('lowMid-hex-input').addEventListener('change', () => updateSlidersFromHex('lowMid'));

            // Add event listeners for mid color sliders
            document.getElementById('mid-hue').addEventListener('input', () => updateColor('mid'));
            document.getElementById('mid-saturation').addEventListener('input', () => updateColor('mid'));
            document.getElementById('mid-value').addEventListener('input', () => updateColor('mid'));
            document.getElementById('mid-hex-input').addEventListener('change', () => updateSlidersFromHex('mid'));

            // Add event listeners for highMid color sliders
            document.getElementById('highMid-hue').addEventListener('input', () => updateColor('highMid'));
            document.getElementById('highMid-saturation').addEventListener('input', () => updateColor('highMid'));
            document.getElementById('highMid-value').addEventListener('input', () => updateColor('highMid'));
            document.getElementById('highMid-hex-input').addEventListener('change', () => updateSlidersFromHex('highMid'));

            // Add event listeners for high color sliders
            document.getElementById('high-hue').addEventListener('input', () => updateColor('high'));
            document.getElementById('high-saturation').addEventListener('input', () => updateColor('high'));
            document.getElementById('high-value').addEventListener('input', () => updateColor('high'));
            document.getElementById('high-hex-input').addEventListener('change', () => updateSlidersFromHex('high'));

            // Set initial hex input values from defaults
            document.getElementById('low-hex-input').value = DEFAULT_LOW_COLOR_HEX;
            document.getElementById('lowMid-hex-input').value = DEFAULT_LOW_MID_COLOR_HEX;
            document.getElementById('mid-hex-input').value = DEFAULT_MID_COLOR_HEX;
            document.getElementById('highMid-hex-input').value = DEFAULT_HIGH_MID_COLOR_HEX;
            document.getElementById('high-hex-input').value = DEFAULT_HIGH_COLOR_HEX;

            // Initial update of sliders and color objects from hex inputs
            updateSlidersFromHex('low');
            updateSlidersFromHex('lowMid');
            updateSlidersFromHex('mid');
            updateSlidersFromHex('highMid');
            updateSlidersFromHex('high');

            renderVisualization('temperature'); // Initial render
        });
    </script>
</body>
</html>
